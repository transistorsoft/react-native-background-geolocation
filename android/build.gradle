plugins {
    id "com.android.library"
    id "com.facebook.react"
}

// Android dependencies
def DEFAULT_COMPILE_SDK_VERSION                     = 36
def DEFAULT_TARGET_SDK_VERSION                      = 36

// Plugin dependencies
def DEFAULT_PLAY_SERVICES_LOCATION_VERSION          = "21.3.0"
def DEFAULT_OK_HTTP_VERSION                         = "4.12.0"
def DEFAULT_ANDROID_PERMISSIONS_VERSION             = "2.1.6"
def DEFAULT_EVENTBUS_VERSION                        = "3.3.1"
def DEFAULT_LOCAL_BROADCAST_MANAGER_VERSION         = "1.0.0"
def DEFAULT_LIFE_CYCLE_RUNTIME_VERSION              = "2.4.1"
def DEFAULT_LIFE_CYCLE_EXTENSIONS_VERSION           = "2.2.0"
def DEFAULT_LOGBACK_VERSION                         = "2.0.1"
def DEFAULT_SLF4J_VERSION                           = "1.7.36"
def DEFAULT_WORK_VERSION                            = "2.8.1"
def DEFAULT_CONCURRENT_FUTURES_VERSION              = "1.1.0"

def safeExtGet(prop, fallback) {
    rootProject.ext.has(prop) ? rootProject.ext.get(prop) : fallback
}

react {
    libraryName = "react-native-background-geolocation"
    codegenJavaPackageName = "com.transistorsoft.rnbackgroundgeolocation"
}
android {
    namespace("com.transistorsoft.rnbackgroundgeolocation")

    compileSdkVersion safeExtGet('compileSdkVersion', DEFAULT_COMPILE_SDK_VERSION)

    defaultConfig {
        minSdkVersion safeExtGet('minSdkVersion', 16)
        targetSdkVersion safeExtGet('targetSdkVersion', DEFAULT_TARGET_SDK_VERSION)
        consumerProguardFiles 'proguard-rules.pro'
        versionCode 1
        versionName "1.0"
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    sourceSets {
        main {
            // Where Codegen put NativeBackgroundGeolocationSpec.java
            java.srcDir("$buildDir/generated/source/codegen/java")
        }
    }
}

repositories{
    maven {
        url './libs'
    }
}

dependencies {
    def playServicesLocationVersion = safeExtGet('playServicesLocationVersion', safeExtGet('googlePlayServicesLocationVersion', DEFAULT_PLAY_SERVICES_LOCATION_VERSION))

    implementation "com.facebook.react:react-native:${safeExtGet('reactNativeVersion', '+')}"
    implementation "com.google.android.gms:play-services-location:$playServicesLocationVersion"
    implementation "com.transistorsoft:tslocationmanager:4.0.0-beta.+"
    implementation 'org.greenrobot:eventbus:3.3.1'
}
